import{r as a,j as t,c as $}from"./assets/global-Ca1wnCDD.js";const U=()=>{const[i,g]=a.useState([]),[T,h]=a.useState(""),[c,x]=a.useState(""),[E,D]=a.useState({}),[R,S]=a.useState("Add Note"),[C,p]=a.useState("black"),[I,f]=a.useState(!1),[k,n]=a.useState(null),[d,v]=a.useState(null),[o,H]=a.useState(!1),j=a.useRef(null),u=a.useRef(null),m=a.useRef({}),N=5e3;a.useEffect(()=>()=>{j.current&&clearTimeout(j.current),u.current&&clearTimeout(u.current),Object.values(m.current).forEach(e=>{clearTimeout(e)})},[]),a.useEffect(()=>{B()},[]);const A=()=>Date.now().toString(36)+Math.random().toString(36).substr(2),B=()=>{chrome.storage.local.get(["notes"],e=>{try{if(e.notes){const r=e.notes.map(s=>s.id?s:{...s,id:A()});g(r),r.some((s,l)=>!e.notes[l].id)&&chrome.storage.local.set({notes:r})}else{const r=[{heading:"Example Heading",text:"This is the Example text format",id:A()}];g(r),chrome.storage.local.set({notes:r})}}catch(r){n("Failed to load notes"),console.error("Error loading notes:",r)}})},b=e=>{chrome.storage.local.set({notes:e},()=>{if(chrome.runtime.lastError){n("Failed to save notes: "+chrome.runtime.lastError.message),console.error("Error saving notes:",chrome.runtime.lastError);return}g(e),n(null)})},F=()=>{if(!I){if(f(!0),c.trim().length>N){n(`Text is too long (max ${N} characters)`),p("red"),u.current=window.setTimeout(()=>{n(null),p("black"),f(!1)},1500);return}if(c.trim()){const e={heading:T.trim()||"No Heading",text:c.trim(),id:A()},r=[...i,e];b(r),S("Note Added!!! ⬇️"),j.current=window.setTimeout(()=>{S("Add Note"),f(!1)},1e3),h(""),x("")}else{p("red");const e="Please provide a heading!!!!!!",r="Please provide a text!!!!!!(Mandatory)";h(e),x(r),u.current=window.setTimeout(()=>{h(""),x(""),p("black"),f(!1)},1e3)}}},L=()=>{window.confirm("Are you sure you want to delete all the notes?")&&chrome.storage.local.remove(["notes"],()=>{if(chrome.runtime.lastError){n("Failed to clear notes: "+chrome.runtime.lastError.message);return}g([]),n(null)})},M=e=>{if(window.confirm("Are you sure you want to delete this note?")){const r=i.filter(s=>s.id!==e);b(r)}},O=(e,r)=>{m.current[r]&&clearTimeout(m.current[r]),navigator.clipboard.writeText(e).then(()=>{D(s=>({...s,[r]:!0})),m.current[r]=window.setTimeout(()=>{D(s=>({...s,[r]:!1})),delete m.current[r]},1e3)}).catch(s=>{console.error("Failed to copy text: ",s),n("Failed to copy to clipboard"),u.current=window.setTimeout(()=>{n(null)},1500)})},P=e=>{H(e.target.checked),e.target.checked||v(null)},G=(e,r)=>{if(!o){e.preventDefault();return}if(v(r),e.dataTransfer.setDragImage){const l=new Image;l.src="data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=",e.dataTransfer.setDragImage(l,0,0)}const s=e.currentTarget;s.style.opacity="0.6",e.dataTransfer.effectAllowed="move"},Q=e=>{o&&(e.currentTarget.style.opacity="1",v(null))},_=e=>{o&&(e.preventDefault(),e.dataTransfer.dropEffect="move")},z=(e,r)=>{if(!o||(e.preventDefault(),!d||d===r))return;const s=i.findIndex(y=>y.id===d),l=i.findIndex(y=>y.id===r);if(s===-1||l===-1)return;const w=[...i],[X]=w.splice(s,1);w.splice(l,0,X),b(w)};return t.jsx("div",{className:"popup-container",children:t.jsxs("div",{className:"header",children:[t.jsxs("div",{className:"title",children:[t.jsx("img",{src:"public/48.png",alt:"Nostalgia",className:"icon"}),t.jsx("div",{className:"heading",children:t.jsx("h1",{children:"Nostalgia"})})]}),k&&t.jsx("div",{className:"error-message",style:{color:"red",padding:"5px",margin:"5px 0"},children:k}),t.jsx("br",{}),t.jsxs("div",{className:"sub-heading",children:[t.jsxs("div",{className:"pastehere",children:[t.jsx("h2",{children:"Paste here"}),t.jsx("button",{onClick:F,disabled:I,children:R})]}),t.jsxs("div",{className:"paste-input",children:[t.jsx("input",{type:"text",placeholder:"Give a heading",value:T,onChange:e=>h(e.target.value),style:{color:C},maxLength:100}),t.jsx("textarea",{rows:3,placeholder:"Enter text here",value:c,onChange:e=>x(e.target.value),style:{color:C},maxLength:N}),c&&t.jsxs("div",{className:"character-count",style:{fontSize:"0.8rem",textAlign:"right"},children:[c.length,"/",N]})]})]}),t.jsx("br",{}),t.jsx("div",{className:"sub-heading",children:t.jsxs("div",{className:"sub-sub",children:[t.jsx("h2",{className:"pt-margin",children:"Previous Texts"}),t.jsx("button",{onClick:L,children:"Clear All"})]})}),i.length>0?t.jsxs("div",{className:"notes-container",children:[t.jsx("div",{className:"drag-div",children:t.jsx("div",{className:"checkbox-container",children:t.jsxs("label",{style:{display:"flex",flexDirection:"row",alignItems:"center",marginLeft:"5px",marginRight:"5px"},children:[t.jsx("input",{type:"checkbox",checked:o,onChange:P}),t.jsx("p",{className:"drag-instructions",style:{fontSize:"0.8rem",fontStyle:"italic",margin:"10px"},children:o?"Drag mode enabled":"Check to enable drag mode"})]})})}),i.map(e=>t.jsxs("div",{className:"copied-text",draggable:o,onDragStart:r=>G(r,e.id),onDragEnd:Q,onDragOver:_,onDrop:r=>z(r,e.id),style:{cursor:o?"move":"default",borderLeft:d===e.id?"3px solid #4a90e2":"none",background:d===e.id?"grey":"#f8f9fa"},children:[t.jsxs("div",{className:"copy-here",children:[t.jsx("p",{children:e.heading}),t.jsxs("div",{className:"button-group",children:[t.jsx("button",{onClick:()=>O(e.text,e.id),className:`copy-btn ${E[e.id]?"copied":""}`,children:E[e.id]?"Copied!":"Copy"}),t.jsx("button",{onClick:()=>M(e.id),className:"delete-btn",children:"Delete"})]})]}),t.jsx("div",{className:"paste-input",children:t.jsx("textarea",{rows:2,value:e.text,readOnly:!0})})]},e.id))]}):t.jsx("p",{children:"No saved texts."})]})})};$(document.getElementById("root")).render(t.jsx(a.StrictMode,{children:t.jsx("div",{className:" w-[300px] h-[500px]",children:t.jsx(U,{})})}));
